% !TEX program = xelatex
\documentclass[]{article}
\usepackage{commons/course}

\begin{document}
\printheader

\section*{سوال اول}
عملا پس نقطه‌هایی که باید
interpolation
را روی آن‌ها بزنیم برابر هستند با
$\left(x_i, \left(x_i\right)^n\right)$
هستند. پس عملا
interpolation
ما برابر است با
\begin{gather*}
    \sum_{k=0}^{n} (x_k)^n L_{n, k} (x) = \sum_{k=0}^{n} \Bigl((x_k)^n \prod_{i=0, i \neq k}^{n} \frac{x - x_i}{x_k - x_i}\Bigr)
\end{gather*}
حال ضریب‌های خواسته شده را بررسی می‌کنیم. در ابتدا مشخص است که برای
$x^n$
در داخل
$\prod$
هیچ ضریبی برای
$x$ها
در صورت وجود ندارد و در نتیجه پس ضریب
$x^n$
برابر است با:
\begin{gather*}
    \sum_{k=0}^{n} \Bigl( (x_k)^n \prod_{i=0, i \neq k}^{n} \frac{1}{x_k - x_i} \Bigr)
\end{gather*}
حال ضریب جمله‌ی
$x^{n-1}$
را حساب می‌کنیم. می‌دانیم که ضریب جلمه‌ی
$x^{n-1}$
در
$\prod_{i=1}^n (x + x_i)$
برابر
$\sum_{i=1}^n x_i$
است. پس در نتیجه ضریب جمله
$x^{n-1}$
در عبارت
interpolation
برابر است با
\begin{gather*}
    \sum_{k=0}^{n} \Bigl((x_k)^n \bigl( \sum_{i=0, i \neq k}^{n} -x_i  \bigr) \bigl( \prod_{i=0, i \neq k}^{n} \frac{1}{x_k - x_i} \bigr) \Bigr)
\end{gather*}
\section*{سوال دوم}
در ابتدا می‌‌دانیم که
$\Delta^2P(0)$
عملا برابر است با
$\Delta P(1) - \Delta P(0)$.
فرض کنید که
$P(x) = ax^4 + bx^3 + cx^2 + dx + e$
است.
پس داریم:
\begin{align*}
    \Delta^4P(0) &= \Delta^3 P(1) - \Delta^3 P(0)\\
    &= \Delta^2 P(2) - \Delta^2 P(1) - (\Delta^2 P(1) - \Delta^2 P(0))\\
    &= \Delta^2 P(2) - 2\Delta^2 P(1) + \Delta^2 P(0)\\
    &= \Delta P(3) - \Delta P(2) - 2(\Delta P(2) - \Delta P(1)) + \Delta P(1) - \Delta P(0)\\
    &= \Delta P(3) - 3\Delta P(2) + 3\Delta P(1) - \Delta P(0)\\
    &= P(4) - P(3) - 3(P(3) - P(2)) + 3(P(2) - P(1)) - (P(1) - P(0))\\
    &= P(4) - 4P(3) + 6P(2) - 4P(1) + P(0)\\
    &= 24a = 24\\
    &\implies \boxed{a = 1}
\end{align*}
همچنین برای
$\Delta^3 P(0)$
داریم:
\begin{align*}
    \Delta^3P(0) &= \Delta^2 P(1) - \Delta^2 P(0)\\
    &= \Delta P(2) - \Delta P(1) - (\Delta P(1) - \Delta P(0))\\
    &= \Delta P(2) - 2\Delta P(1) + \Delta P(0)\\
    &= P(3) - P(2) - 2(P(2) - P(1)) + P(1) - P(0)\\
    &= P(3) - 3P(2) + 3P(1) - P(0)\\
    &= 36a + 6b = 6\\
    &\implies \boxed{b = -5}
\end{align*}
همچنین برای
$\Delta^2 P(0)$
داریم:
\begin{align*}
    \Delta^2P(0) &= \Delta P(1) - \Delta P(0)\\
    &= P(2) - P(1) - (P(1) - P(0))\\
    &= P(2) - 2 P(1) + P(0)\\
    &= 14a + 6b + 2c = 0\\
    &\implies \boxed{c = 8}
\end{align*}
در نهایت برای خود خواسته‌ی سوال داریم:
\begin{align*}
    \Delta^2P(10) &= \Delta P(11) - \Delta P(10)\\
    &= P(12) - P(11) - (P(11) - P(10))\\
    &= P(12) - 2 P(11) + P(10)\\
    &= 1454a + 66b + 2c = 0\\
    &\implies \boxed{\Delta^2P(10) = 1140}
\end{align*}
\section*{سوال سوم}
\subsection*{قسمت الف}
طبق کتاب داریم:
\[
\begin{bmatrix}
    1 & 0 & 0 & 0 \\
    h_0 & 2(h_0+h_1) & h_1 & 0 \\
    0 & h_1 & 2(h_1+h_2) & h_2\\
    0 & 0 & 0 & 1 \\
\end{bmatrix}
\begin{bmatrix}
    c_0\\
    c_1\\
    c_2\\
    c_3
\end{bmatrix}
=
\begin{bmatrix}
    0\\
    \frac{3}{h_1}(a_2 - a_1) - \frac{3}{h_0}(a_1 - a_0)\\
    \frac{3}{h_2}(a_3 - a_2) - \frac{3}{h_1}(a_2 - a_1)\\
    0
\end{bmatrix}
\]
همچنین پارامتر‌های ما به صورت زیر هستند:
\begin{gather*}
    h_0 = 0 - (-1) = 1, \quad h_1 = 1 - 0 = 1, \quad h_2 = 2 - 1 = 1\\
    f(x_i) = a_i
\end{gather*}
پس معادله‌ی ما به صورت زیر است:
\[
\begin{bmatrix}
    1 & 0 & 0 & 0 \\
    1 & 4 & 1 & 0 \\
    0 & 1 & 4 & 1\\
    0 & 0 & 0 & 1 \\
\end{bmatrix}
\begin{bmatrix}
    c_0\\
    c_1\\
    c_2\\
    c_3
\end{bmatrix}
=
\begin{bmatrix}
    0\\
    1.5\\
    3\\
    0
\end{bmatrix}
\]
پس داریم:
\begin{gather*}
    c_0 = 0\\
    c_1 = 0.2\\
    c_2 = 0.7\\
    c_3 = 0
\end{gather*}
\[
\begin{array}{cccc}
    a_0 = 0.5 & b_0 = (a_1 - a_0)/h_0 - h_0 (c_1-c_0) = 0.43333333 & c_0 = 0 & d_0 = (c_1 - c_0) / (3h_0) = 0.06666667\\
    a_1 = 1 & b_1 = (a_2 - a_1)/h_1 - h_1 (c_2-c_1) = 0.63333333 & c_1 = 0.2 & d_1 = (c_2 - c_1) / (3h_1) = 0.16666667\\
    a_2 = 2 & b_2 = (a_3 - a_2)/h_2 - h_2 (c_3-c_2) = 1.53333333 & c_2 = 0.7 & d_2 = (c_3 - c_2) / (3h_2) = -0.23333333
\end{array}
\]
پس معادلات به صورت زیر هستند:
\begin{gather*}
    0.5 + 0.43333333 (x + 1) + 0.06666667 (x + 1)^3 \quad -1 \le x \le 0\\
    1 + 0.63333333 x + 0.2x^2 + 0.16666667 x^3 \quad 0 \le x \le 1\\
    2 + 1.53333333 (x - 1) + 0.7 (x-1)^2 -0.23333333 (x - 1)^3 \quad 1 \le x \le 2
\end{gather*}
\subsection*{قسمت ب}
طبق کتاب داریم:
\[
\begin{bmatrix}
    2h_0 & h_0 & 0 & 0 \\
    h_0 & 2(h_0+h_1) & h_1 & 0 \\
    0 & h_1 & 2(h_1+h_2) & h_2\\
    0 & 0 & h_2 & 2h_2 \\
\end{bmatrix}
\begin{bmatrix}
    c_0\\
    c_1\\
    c_2\\
    c_3
\end{bmatrix}
=
\begin{bmatrix}
    \frac{3}{h_0} (a_1 - a_0) - 3f'(a)\\
    \frac{3}{h_1}(a_2 - a_1) - \frac{3}{h_0}(a_1 - a_0)\\
    \frac{3}{h_2}(a_3 - a_2) - \frac{3}{h_1}(a_2 - a_1)\\
    3f'(b) - \frac{3}{h_{n-1}} (a_n - a_{n-1})
\end{bmatrix}
\]
همچنین پارامتر‌های ما به صورت زیر هستند:
\begin{gather*}
    h_0 = 0 - (-1) = 1, \quad h_1 = 1 - 0 = 1, \quad h_2 = 2 - 1 = 1\\
    f(x_i) = a_i
\end{gather*}
پس معادله‌ی ما به صورت زیر است:
\[
\begin{bmatrix}
    2 & 1 & 0 & 0 \\
    1 & 4 & 1 & 0 \\
    0 & 1 & 4 & 1\\
    0 & 0 & 1 & 2 \\
\end{bmatrix}
\begin{bmatrix}
    c_0\\
    c_1\\
    c_2\\
    c_3
\end{bmatrix}
=
\begin{bmatrix}
    -1.5\\
    1.5\\
    3\\
    -9
\end{bmatrix}
\]
پس داریم:
\begin{gather*}
    c_0 = -0.76666667\\
    c_1 = 0.03333333\\
    c_2 = 2.13333333\\
    c_3 = -5.56666667
\end{gather*}
\[
\begin{array}{cccc}
    a_0 = 0.5 & b_0 = 1 & c_0 = -0.76666667 & d_0 = 0.26666667\\
    a_1 = 1 & b_1 = 0.26666667 & c_1 = 0.03333333 & d_1 = 0.7\\
    a_2 = 2 & b_2 = 2.43333333 & c_2 = 2.13333333 & d_2 = -2.56666667
\end{array}
\]
پس معادلات به صورت زیر هستند:
\begin{gather*}
    0.5 + (x + 1) -0.76666667 (x + 1)^2 + 0.26666667 (x + 1)^3 \quad -1 \le x \le 0\\
    1 + 0.26666667 x + 0.03333333x^2 + 0.7 x^3 \quad 0 \le x \le 1\\
    2 + 2.43333333 (x - 1) + 2.13333333 (x-1)^2 -2.56666667 (x - 1)^3 \quad 1 \le x \le 2
\end{gather*}
\section*{سوال چهارم}
\section*{سوال پنجم}
به صورت کلی هیچ مشکلی پیش نمی‌آید اگر دو شرط زیر را نیز به شرط‌های چند جمله‌ای اضافه بکنیم.
\begin{align*}
    f'(0) &= P'(0)\\
    f'(2) &= P'(2)
\end{align*}
با این کار از
\lr{Hermite interpolation}
استفاده می‌کنیم که چند جمله‌ای را تخمین بزنیم.
حال مقدار‌های چند جمله‌ای در نقاط خواسته شده را حساب می‌کنیم.
\begin{gather*}
    P(0) = 0, P(1) \approx 0.6931, P(2) = 1.0986\\
    P'(0) = 1, P'(1) \approx \frac{1}{2}, P'(2) = \frac{1}{3}
\end{gather*}
پس داریم:
\[
\begin{array}{ccccccc}
z_0 = 0 & f[z_0] = 0 \\
&& f'(0) = 1 \\
z_1 = 0 & f[z_1] = 0 && f[z_0,z_1,z_2] = -0.3069\\
&& f[z_1,z_2] = 0.6931 && 0.1138\\
z_2 = 1 & f[z_2] = 0.6931 && f[z_1,z_2,z_3] = -0.1931 && -0.0323\\
&& f'(1) = \frac{1}{2} && 0.0493 && 0.0092\\
z_3 = 1 & f[z_3] = 0.6931 && f[z_2,z_3,z_4] = -0.0945 && -0.014 \\
&& f[z_3,z_4] = 0.4055 && 0.0223 \\
z_4 = 2 & f[z_4] = 1.0986&&f[z_3,z_4,z_5] = -0.0722\\
&&f'(2) = \frac{1}{3}\\
z_5 = 2 & f[z_5] = 1.0986\\
\end{array}
\]
پس چند جمله‌ای ما به صورت زیر است:
\begin{gather*}
    0 + x -0.3069 x (x-1) + 0.1138 x (x-1)^2 -0.0323 x (x-1)^2 (x-2) + 0.0092 x (x-1)^2 (x-2)^2
\end{gather*}
حال برای خطا داریم:
\begin{gather*}
    \frac{f^{(3)}(\xi)}{3!}\prod_i(x - x_i)^{k_i}, \quad 0 \le \xi \le 2
\end{gather*}
از آنجا که مشتق سوم نزولی است پس زمانی که
$\xi = 0$
باشد بیشترین مقدار 2 را دارد مشتق. پس داریم:
\begin{gather*}
    \frac{2}{6} (x - 0)^2 (x - 1)^2 (x - 2)^2 
\end{gather*}
که
$x$
در اینجا نقطه‌‌ای است که می‌خواهیم مقدار آن را تخمین بزنیم.
\section*{سوال ششم}
% https://math.stackexchange.com/a/159883/424863
فرض کنید که
$g(x) = f[x, x_0, x_1, \dots, x_n]$
است. حال
$g[u, v]$
را در نظر بگیرید. مشخص است که طبق تعریف که
$g[u, v] = \frac{g(u) - g(v)}{u - v}$
است مشخص است که
$\lim_{(u, v) \rightarrow (x, x)} g[u, v] = \frac{d}{dx} g(x)$.
همچنین می‌دانیم که
$\frac{g(u) - g(v)}{u - v}$
همان
$\frac{f[u, x_0, x_1, \dots, x_n] - f[v, x_0, x_1, \dots, x_n]}{u - v}$
است که در اینجا برابر می‌شود با
$f[x, x, x_0, x_1, \dots, x_n]$.
\section*{سوال هفتم}
\section*{سوال هشتم}
\end{document}
