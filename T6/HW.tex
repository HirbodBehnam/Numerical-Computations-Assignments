% !TEX program = xelatex
\documentclass[]{article}
\usepackage{commons/course}

\begin{document}
\printheader

\section*{سوال اول}
\subsection*{قسمت اول}
% https://www.youtube.com/watch?v=_yn3F8h4Nkc
برای خود رگرشن خطی به صورت برداری داریم:
\begin{gather*}
    \mathbf{y} = \mathbf{X} \mathbf{\theta} + \mathbf{\epsilon} \implies
    \mathbf{\epsilon} = \mathbf{y} - \mathbf{X} \mathbf{\theta}
\end{gather*}
حال نکته‌ای که باید توجه بکنید این است که در صورتی که ما عبارت
$(\mathbf{y} - \mathbf{X} \mathbf{\theta})^T(\mathbf{y} - \mathbf{X} \mathbf{\theta})$
را حساب بکنیم عملا مثل این است که تک تک عضو‌های
$\mathbf{\epsilon}$
را به توان دو برسانیم و با هم جمع بزنیم.
دقت بکنید که یک بردار افقی را ضرب در یک بردار عمودی کرده‌ایم که نتیجه‌ی آن صرفا یک عدد می‌شود.
همچنین می‌توان دو منفی نیز در ضرب ماتریس‌ها ضرب کرد که داشته باشیم:
\begin{gather*}
    (\mathbf{X} \mathbf{\theta} - \mathbf{y})^T(\mathbf{X} \mathbf{\theta} - \mathbf{y})
    =
    \sum_{i=1}^n (\mathbf{\theta}^T \mathbf{x}^{(i)} - \mathbf{y}^{(i)})^2
\end{gather*}
حال اگر بخواهیم وزن داخل سوال را نیز در نظر بگیریم عملا مثل این است که قبل از جمع کردن تمامی
عضو‌های
$\mathbf{\epsilon}$
آن‌ها را در یک عدد ضرب بکنیم که این عدد برای هر عضو متفاوت است. برای اینکه با بردار و ماتریس
این را مدل بکنیم عملا کافی است که یک ماتریس قطری داشته باشیم که بردار
$(\mathbf{X} \mathbf{\theta} - \mathbf{y})^T$
را در آن ضرب بکنیم. با این کار هر کدام از عضو‌‌های
$(\mathbf{X} \mathbf{\theta} - \mathbf{y})^T$
به ترتیب در هر یک از اعضای قطر ماتریس ذکر شده ضرب می‌شوند. با این تعریف عملا باید ماتریسی مثل
$\mathbf{W}$
تعریف بکنیم که قطری است و هر عضو بر روی قطر آن برابر
$w(i)$
است. با این کار عملا داریم:
\begin{gather*}
    (\mathbf{X} \mathbf{\theta} - \mathbf{y})^T \mathbf{W} (\mathbf{X} \mathbf{\theta} - \mathbf{y})
    =
    \sum_{i=1}^n w(i) (\mathbf{\theta}^T \mathbf{x}^{(i)} - \mathbf{y}^{(i)})^2
\end{gather*}
% https://www.stat.cmu.edu/~cshalizi/mreg/15/lectures/24/lecture-24--25
\subsection*{قسمت دوم}
حال با باز کردن این عبارت داریم:
\begin{gather*}
    \mathbf{y}^T \mathbf{W} \mathbf{y} - \mathbf{y}^T \mathbf{W} \mathbf{X} \mathbf{\theta} - \mathbf{\theta}^T \mathbf{X} ^T \mathbf{W} \mathbf{y} + \mathbf{\theta}^T \mathbf{X}^T \mathbf{W} \mathbf{X} \mathbf{\theta}
\end{gather*}
حال با مشتق جزئی گرفتن نسبت به $\theta$ داریم:
\begin{gather*}
    \nabla_\theta J(\theta) = - \mathbf{X}^T \mathbf{W} \mathbf{y} + \mathbf{X}^T \mathbf{W} \mathbf{X} \mathbf{\theta}
\end{gather*}
حال این عبارت را برابر 0 قرار می‌دهیم و برابر
$\mathbf{\theta}$
حل می‌کنیم. داریم:
\begin{gather*}
    \mathbf{X}^T \mathbf{W} \mathbf{y} = \mathbf{X}^T \mathbf{W} \mathbf{X} \mathbf{\theta}\\
    \implies\\
    \mathbf{\theta} = (\mathbf{X}^T \mathbf{W} \mathbf{X})^{-1} \mathbf{X}^T \mathbf{W} \mathbf{y}
\end{gather*}
\section*{سوال چهارم}
عملا در ابتدا داریم:
\begin{gather*}
    D = \begin{bmatrix}
        4 & 0 & 0\\
        0 & 4 & 0\\
        0 & 0 & 4
    \end{bmatrix}
    \implies
    D^{-1} = \begin{bmatrix}
        0.25 & 0 & 0\\
        0 & 0.25 & 0\\
        0 & 0 & 0.25
    \end{bmatrix}\\
    L + U = \begin{bmatrix}
        0 & -1 & 0\\
        -1 & 0 & -1\\
        0 & -1 & 0
    \end{bmatrix}
\end{gather*}
حال کافی است که طبق فرمول
$\mathbf{x}^{(k+1)} = D^{-1} (\mathbf{b} - (L+U) \mathbf{x}^{(k)})$
و مقدار اولیه
$\mathbf{x}^{(0)} = \begin{bmatrix}
    0\\
    0\\
    0 
\end{bmatrix}$
تا
$\mathbf{x}^{(5)}$
حساب بکنیم. پس داریم:
\begin{align*}
    \mathbf{x}^{(1)} = \begin{bmatrix}
        0.25 & 0 & 0\\
        0 & 0.25 & 0\\
        0 & 0 & 0.25
    \end{bmatrix} \left(\begin{bmatrix}
        3\\
        2\\
        3
    \end{bmatrix} - \begin{bmatrix}
        0 & -1 & 0\\
        -1 & 0 & -1\\
        0 & -1 & 0
    \end{bmatrix}\begin{bmatrix}
        0\\
        0\\
        0
    \end{bmatrix}\right)
    &=
    \begin{bmatrix}
        0.75\\
        0.5\\
        0.75
    \end{bmatrix}\\
    \mathbf{x}^{(2)} = \begin{bmatrix}
        0.25 & 0 & 0\\
        0 & 0.25 & 0\\
        0 & 0 & 0.25
    \end{bmatrix} \left(\begin{bmatrix}
        3\\
        2\\
        3
    \end{bmatrix} - \begin{bmatrix}
        0 & -1 & 0\\
        -1 & 0 & -1\\
        0 & -1 & 0
    \end{bmatrix}\begin{bmatrix}
        0.75\\
        0.5\\
        0.75
    \end{bmatrix}\right)
    &=
    \begin{bmatrix}
        0.875\\
        0.875\\
        0.875
    \end{bmatrix}\\
    \mathbf{x}^{(3)} = \begin{bmatrix}
        0.25 & 0 & 0\\
        0 & 0.25 & 0\\
        0 & 0 & 0.25
    \end{bmatrix} \left(\begin{bmatrix}
        3\\
        2\\
        3
    \end{bmatrix} - \begin{bmatrix}
        0 & -1 & 0\\
        -1 & 0 & -1\\
        0 & -1 & 0
    \end{bmatrix}\begin{bmatrix}
        0.875\\
        0.875\\
        0.875
    \end{bmatrix}\right)
    &=
    \begin{bmatrix}
        0.96875\\
        0.9375\\
        0.96875
    \end{bmatrix}\\
    \mathbf{x}^{(4)} = \begin{bmatrix}
        0.25 & 0 & 0\\
        0 & 0.25 & 0\\
        0 & 0 & 0.25
    \end{bmatrix} \left(\begin{bmatrix}
        3\\
        2\\
        3
    \end{bmatrix} - \begin{bmatrix}
        0 & -1 & 0\\
        -1 & 0 & -1\\
        0 & -1 & 0
    \end{bmatrix}\begin{bmatrix}
        0.96875\\
        0.9375\\
        0.96875
    \end{bmatrix}\right)
    &=
    \begin{bmatrix}
        0.984375\\
        0.984375\\
        0.984375
    \end{bmatrix}\\
    \mathbf{x}^{(5)} = \begin{bmatrix}
        0.25 & 0 & 0\\
        0 & 0.25 & 0\\
        0 & 0 & 0.25
    \end{bmatrix} \left(\begin{bmatrix}
        3\\
        2\\
        3
    \end{bmatrix} - \begin{bmatrix}
        0 & -1 & 0\\
        -1 & 0 & -1\\
        0 & -1 & 0
    \end{bmatrix}\begin{bmatrix}
        0.984375\\
        0.984375\\
        0.984375
    \end{bmatrix}\right)
    &=
    \boxed{\begin{bmatrix}
        0.99609375\\
        0.9921875\\
        0.99609375
    \end{bmatrix}}\\
\end{align*}
\section*{سوال پنجم}
در ابتدا دستگاه معادلات را تشکیل می‌دهیم:
\begin{gather*}
    A = \begin{bmatrix}
        25 & 5 & 1\\
        64 & 8 & 1\\
        144 & 12 & 1
    \end{bmatrix}
    \quad
    \mathbf{b} = \begin{bmatrix}
        106.8\\
        177.2\\
        279.2
    \end{bmatrix}
\end{gather*}
پس عملا داریم:
\begin{gather*}
    L_* = \begin{bmatrix}
        25 & 0 & 0\\
        64 & 8 & 0\\
        144 & 12 & 1
    \end{bmatrix}
    \implies
    L_*^{-1} = \begin{bmatrix}
        0.04 & 0 & 0\\
        -0.32 & 0.125 & 0\\
        -1.92 & -1.5 & 1
    \end{bmatrix}
    \\
    U = \begin{bmatrix}
        0 & 5 & 1\\
        0 & 0 & 1\\
        0 & 0 & 0
    \end{bmatrix}
\end{gather*}
همچنین می‌دانیم که فرمول هر مرحله
$\mathbf{x}^{(k+1)} = L_*^{-1} (\mathbf{b} - U \mathbf{x}^{(k)})$
است. حال در صورتی که کمی جلو برویم متوجه می‌شویم که
اصلا جواب همگرا نمی‌شود!
\begin{align*}
    \mathbf{x}^{(1)} = \begin{bmatrix}
        0.04 & 0 & 0\\
        -0.32 & 0.125 & 0\\
        -1.92 & -1.5 & 1
    \end{bmatrix} \left(\begin{bmatrix}
        106.8\\
        177.2\\
        279.2
    \end{bmatrix} - \begin{bmatrix}
        0 & 5 & 1\\
        0 & 0 & 1\\
        0 & 0 & 0
    \end{bmatrix}\begin{bmatrix}
        1\\
        2\\
        5
    \end{bmatrix}\right)
    &=
    \begin{bmatrix}
        3.672\\
        -7.851\\
        -155.356
    \end{bmatrix}\\
    \mathbf{x}^{(2)} = \begin{bmatrix}
        0.04 & 0 & 0\\
        -0.32 & 0.125 & 0\\
        -1.92 & -1.5 & 1
    \end{bmatrix} \left(\begin{bmatrix}
        106.8\\
        177.2\\
        279.2
    \end{bmatrix} - \begin{bmatrix}
        0 & 5 & 1\\
        0 & 0 & 1\\
        0 & 0 & 0
    \end{bmatrix}\begin{bmatrix}
        3.672\\
        -7.851\\
        -155.356
    \end{bmatrix}\right)
    &=
    \begin{bmatrix}
        12.05644\\
        -54.88202\\
        -798.34312
    \end{bmatrix}\\
    \mathbf{x}^{(3)} = \begin{bmatrix}
        0.04 & 0 & 0\\
        -0.32 & 0.125 & 0\\
        -1.92 & -1.5 & 1
    \end{bmatrix} \left(\begin{bmatrix}
        106.8\\
        177.2\\
        279.2
    \end{bmatrix} - \begin{bmatrix}
        0 & 5 & 1\\
        0 & 0 & 1\\
        0 & 0 & 0
    \end{bmatrix}\begin{bmatrix}
        12.05644\\
        -54.88202\\
        -798.34312
    \end{bmatrix}\right)
    &=
    \begin{bmatrix}
        47.1821288\\
        -255.5141404\\
        -3448.8568624
    \end{bmatrix}
\end{align*}
دلیل اینکه این اتفاق می‌افتد به خاطر این است که
$||L_*^{-1} U|| \ge 1$
است که در این مسئله عملا برابر است با
$10.32$.
\end{document}
